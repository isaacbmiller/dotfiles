# remember to run `source init.sh`

# Check if uv is installed
if ! command -v uv &> /dev/null
then
    curl -LsSf https://astral.sh/uv/install.sh | sh
fi
source $HOME/.cargo/env
# check if .venv is a folder
if [ ! -d ".venv" ]; then
    uv venv
fi

source .venv/bin/activate
alias uvpi="uv pip install"
alias gcm="git commit -s -m"

git config --global user.email "isaacbmiller@gmail.com"
git config --global user.name "isaacbmiller"

if ! command -v tmux &> /dev/null
then
    sudo apt install tmux
fi

if ! command -v gh &> /dev/null
then
    sudo apt install gh -y
    gh auth login
fi

# check if dspy is a folder
if [ ! -d "dspy" ]; then
    git clone https://github.com/stanfordnlp/dspy.git
fi

# Check if dspy is installed
if ! uv pip list | grep -q "dspy"; then
    echo "Installing dspy"
    uvpi -e ./dspy
fi

# sudo apt install zsh
if ! command -v zsh &> /dev/null
then
    sudo apt install zsh -y
fi

sudo chsh -s $(which zsh)
# get zshrc from the same working directory or check ./dotfiles/.zshrc
if [ ! -f ~/.zshrc ]; then
    if [ -f .zshrc ]; then
        cp .zshrc ~/.zshrc
    else
        cp ./dotfiles/.zshrc ~/.zshrc
    fi
fi

uvpi ipykernel vllm setuptools jupyter

# vllm serve Qwen/Qwen2-VL-7B-Instruct --trust-remote-code --limit-mm-per-prompt image=16 --seed 42
