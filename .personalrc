# remember to run `source init.sh`

# Check if uv is installed
if ! command -v uv &> /dev/null
then
    curl -LsSf https://astral.sh/uv/install.sh | sh
fi
source $HOME/.cargo/env
# check if .venv is a folder
if [ ! -d ".venv" ]; then
    uv venv
fi

source .venv/bin/activate
alias uvpi="uv pip install"

git config --global user.email "isaacbmiller@gmail.com"
git config --global user.name "isaacbmiller"

if ! command -v tmux &> /dev/null
then
    sudo apt install tmux
fi

# check if dspy is a folder
if [ ! -d "dspy" ]; then
    git clone -b mm-adapter https://github.com/stanfordnlp/dspy.git
fi

# Check if dspy is installed
if ! uv pip list | grep -q "dspy"; then
    echo "Installing dspy"
    uvpi -e ./dspy
fi

uvpi ipykernel vllm setuptools jupyter

# vllm serve Qwen/Qwen2-VL-7B-Instruct --trust-remote-code --limit-mm-per-prompt image=16 --seed 42
